En esta pr√°ctica continuamos nuestro recorrido por el mundo de las operaciones de aprendizaje autom√°tico (MLOps). Antes de avanzar hacia procesos m√°s complejos, es esencial contar con las herramientas adecuadas para instalar, actualizar y gestionar las dependencias de nuestros proyectos.

Nos enfocaremos en el uso de gestores de paquetes como `conda` y `pip`, que nos permitir√°n construir entornos reproducibles, mantener versiones compatibles de librer√≠as y facilitar la colaboraci√≥n entre equipos. Estas habilidades ser√°n clave para desarrollar proyectos robustos y eficientes a lo largo del curso de MLOps.

## üéØ Objetivo

Esta pr√°ctica tiene como objetivo familiarizarse con el uso de gestores de paquetes para instalar, gestionar y documentar dependencias en proyectos de MLOps, asegurando entornos consistentes y controlados para el desarrollo y despliegue de modelos.

## Instalaci√≥n de Conda o Miniconda

- Descargue e instala `conda` o `miniconda`. `Conda` incluye muchos paquetes, mientras que `miniconda` es m√°s ligera. Para los fines del curso se puede instalar `miniconda`.  Las instrucciones para la instalaci√≥n de Miniconda se encuentran en: [https://www.anaconda.com/docs/getting-started/miniconda/install](https://www.anaconda.com/docs/getting-started/miniconda/install). 

    !!! note "Observaci√≥n-1"
        Recuerde leer las instrucciones para Linux desde la terminal (*Linux terminal installer*).

    !!! note "Observaci√≥n-2" 
        Cuando se le pregunte si desea modificar la configuraci√≥n del shell para inicializar conda cada vez que abras un nuevo shell y para reconocer los comandos de conda autom√°ticamente, responda **YES**.

- Verifica la instalaci√≥n. Si no funciona, puede ser necesario configurar la variable de entorno correspondiente. Si se ha instalado con √©xito `miniconda`, entonces deber√≠as ser capaz de ejecutar el comando `conda --version` en la terminal.

    ![Entorno base en conda](recursos/imagen2.gif)

    Conda siempre indicara en que entorno est√°s actualmente, indicado por (`env_name`) en el prompt. Por defecto, siempre se iniciar√° en el entorno (`base`).

## Creaci√≥n de entornos virtuales

- Dentro del directorio principal denominada `Practicas-MLOPS` crea un subdirectorio `Practica-2` para alojar los ejercicios correspondientes a este tema.

Las preguntas de las siguientes tareas responder en la plataforma virtual. Si no esta familiarizado con `conda` puede revisar [informaci√≥n de los comandos principales](recursos/conda_cheatsheet.pdf).

- Crear un nuevo entorno virtual. Aseg√∫rarse de que se llama `mi_entorno` y que instala la versi√≥n 3.11 de Python. 

    - ¬øQu√© comando deber√≠as ejecutar para hacer esto?
    - ¬øQu√© comando de conda da una lista de todos los entornos creados?
    - ¬øQu√© comando de conda se puede usar para activar el entorno creado?
    - ¬øQu√© comando de conda da una lista de los paquetes instalados en el entorno actual?

- Pruebe de instalar el paquete `dotenv` dentro del entorno. Lo recomendable es instalar el paquete usando `conda`, sin embargo, es bastante seguro usar `pip` dentro de conda hoy en d√≠a. **Use `pip` esta vez**, y una vez instale el paquete cree un archivo de Python `programa_entorno.py` para cargar las variables de entorno desde el archivo `ventorno.env`. **__!! Recuerda la √∫ltima tarea de la [pr√°ctica previa](p1.md#mi-ancla) !!__**.

- Verifica que el archivo de Python `programa_entorno.py` imprime una de las variables del archivo `ventorno.env`.

- ¬øC√≥mo exportar f√°cilmente la lista de paquetes instalados en el entorno a un archivo de texto? Aseg√∫rate de exportarlo a un archivo llamado `environment.yaml`, ya que conda usa otro formato por defecto que pip.

- Inspeccione el archivo para ver qu√© contiene. El archivo `environment.yaml` que has creado es una forma de **asegurar la reproducibilidad entre usuarios** porque cualquiera deber√≠a ser capaz de obtener una copia exacta de tu entorno si tiene tu archivo `environment.yaml`. 

- ¬øEl paquete `dotenv` recientemente instalado en el entorno `conda` forma parte de la lista?. ¬øPorqu√© no est√° en la lista si fuese el caso? Puedes crear un archivo `environment1.yaml` que contenga tambi√©n el paquete `dotenv`.

- Intente crear un nuevo entorno (`mi_entorno_copia`) directamente desde su archivo `environment.yaml` y compruebe que los paquetes que se instalan coinciden exactamente con los que ten√≠a originalmente.

- ¬øCu√°l es el comando pip correspondiente que da una lista de todos los paquetes `pip` instalados? ¬øY c√≥mo exportar esto a un archivo `requirements.txt`?

- Si echas un vistazo a los requisitos que tanto `pip` como `conda` producen, ver√°s que a menudo est√°n llenos de muchos m√°s paquetes de los que est√°s usando en tu proyecto. Lo que te interesa son los paquetes que importas en tu c√≥digo: `from package import module`. Una forma de evitar esto es usar el paquete `pipreqs`, que autom√°ticamente escanear√° tu proyecto y crear√° un archivo de requisitos espec√≠fico para √©l.  

- Luego de instalar `pipreqs` en el **entorno de copia**, pruebe este paquete sobre el c√≥digo de los archivos de Python de la carpeta en la Practica-1.

- ¬øQu√© aspecto tiene el archivo `requirements.txt` que produce `pipreqs` comparado con los archivos producidos por `pip` o `conda`?

!!! note "Importante"
    Si bien los m√©todos mencionados en los ejercicios son excelentes maneras de construir archivos de requisitos autom√°ticamente, a veces es m√°s f√°cil sentarse y crear manualmente los archivos, ya que de esa manera te aseguras de que s√≥lo se instalen los requisitos m√°s necesarios al crear un nuevo entorno.
