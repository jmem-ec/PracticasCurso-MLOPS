En proyectos de ciencia de datos o machine learning, los conjuntos de datos y modelos pueden ser muy grandes y dif√≠ciles de gestionar dentro de Git. Para resolver esto, DVC (Data Version Control) ofrece una forma eficiente de versionar y compartir archivos grandes sin almacenarlos directamente en el repositorio.

DVC permite configurar un almacenamiento remoto (Remote Storage) para sincronizar autom√°ticamente los archivos grandes con servicios como Google Cloud Storage, Google Drive, S3, entre otros. As√≠, se facilita la colaboraci√≥n en equipo y la reproducci√≥n de experimentos.

> üìùDVC act√∫a como un complemento de Git: mientras Git versiona el c√≥digo, DVC se encarga de los datos y modelos.

## üéØ Objetivos
Aprender a gestionar datos de forma eficiente y colaborativa en proyectos de ciencia de datos mediante la herramienta DVC (Data Version Control). Al finalizar esta pr√°ctica, podr√°s:

- Instalar y configurar DVC en tu entorno local.
- Entender c√≥mo DVC complementa a Git para versionar y rastrear archivos grandes.
- Configurar un almacenamiento remoto para compartir datos con tu equipo.

## Requisitos Previos

- Tener instalado git.
- Contar con una cuenta de Google.

## Instalaci√≥n de DVC
> üí° Se recomienda realizar esta instalaci√≥n dentro de un entorno Conda previamente creado para el proyecto.

1. Activar tu entorno Conda
    ```bash
    conda activate nombre-del-entorno
    ```
2. Instalar DVC
La forma m√°s directa es usando pip, ya que DVC se encuentra activamente mantenido en PyPI:
    ```bash
    pip install dvc
    ```
Tambi√©n se recomienda para esta practica instalar DVC con soporte para almacenamiento en la nube. Para usar Google Drive:
    ```bash
    pip install 'dvc[gdrive]'
    ```
Y para usar Google Cloud Storage
    ```bash
    pip install 'dvc[gcs]'
    ```

    > üí° Se puede usar el comando `pip install 'dvc[all]'` para instalar soporte para todos los  principales backends de almacenamiento remoto, incluyendo:
    >
    >   - Google Drive (gdrive)
    >   - Google Cloud Storage (gcs)
    >   - Amazon S3 (s3)
    >   - Azure Blob Storage (azure)
    >   - SSH, HDFS, WebDAV, entre otros.
    >
    > Porsupuesto, la instalaci√≥n con `[all]` puede tardar m√°s y ocupar m√°s espacio, ya que instala muchas dependencias adicionales.

3. Verificar instalaci√≥n
    ```bash
    dvc --version
    ```
## üîß Parte 1: Configurar Google Drive como almacenamiento remoto en DVC

Google Drive puede usarse como un almacenamiento remoto para proyectos gestionados con DVC. Esta opci√≥n es √∫til para proyectos colaborativos que usan almacenamiento en la nube gratuito y accesible. A continuaci√≥n se detallan los pasos para conectar tu proyecto a Google Drive.

### ‚òÅÔ∏è Crear y conectar una carpeta en Google Drive
1. Accede a Google Drive.
2. Crea una nueva carpeta y as√≠gnale un nombre √∫nico (por ejemplo, dvc-proyecto-datos).
3. Haz clic derecho sobre la carpeta y selecciona "Compartir".
4. Configura el acceso como "Cualquiera con el enlace puede ver".
5. Copia el identificador de la carpeta desde la URL. Por ejemplo:

https://drive.google.com/drive/folders/1A2B3C4D5E6F7G8H9I

## üîß Parte 2: Configurar Google Drive como almacenamiento remoto en DVC

**Google Cloud Storage (GCS)** puede usarse como un almacenamiento remoto para proyectos gestionados con DVC. Esta opci√≥n es ideal para proyectos colaborativos que requieren mayor capacidad, control de acceso y velocidad de transferencia, especialmente en entornos de producci√≥n o investigaci√≥n. A continuaci√≥n se detallan los pasos para conectar tu proyecto a Google Cloud Storage.

### ‚òÅÔ∏è Crear un Bucket en Google Cloud Storage

1. Accede a [Google Cloud Console](https://console.cloud.google.com/).
2. Aseg√∫rate de haber creado un **nuevo proyecto** espec√≠ficamente para esta pr√°ctica.
3. En el men√∫ de navegaci√≥n, selecciona **"Cloud Storage"**, luego ve a **"Buckets"** y haz clic en **"Create a new bucket"**.
4. Asigna un **nombre √∫nico** a tu bucket.
5. Selecciona la regi√≥n **`us-east1`**.
6. Haz clic en **"Continue"** hasta completar la creaci√≥n del bucket.

---

### üîê Obtener credenciales para conectar DVC con GCP

Una vez creado el bucket, es necesario obtener las credenciales para conectar el almacenamiento remoto de GCP con tu proyecto DVC:

1. Ve a **IAM & Admin** y selecciona **Service Accounts** en la barra lateral izquierda.
2. Haz clic en el bot√≥n **"Create Service Account"** para crear una nueva cuenta de servicio que usar√°s para conectar con el proyecto DVC.
3. Asigna un **nombre e ID** a esta cuenta (por ejemplo, `lab2`) y deja la configuraci√≥n predeterminada.
4. Haz clic en **"Create and Continue"**.
5. En la secci√≥n de permisos, selecciona **Owner** en el men√∫ desplegable y haz clic en **"Continue"**.
6. A√±ade tu usuario para que tenga acceso a esta cuenta de servicio y haz clic en **"Done"**.

---

### üîë Descargar credenciales

1. Ser√°s redirigido a la p√°gina de **Service Accounts**.
2. Busca tu cuenta de servicio reci√©n creada, haz clic en **"Actions"** (√≠cono de tres puntos), y selecciona **"Manage keys"**.
3. Haz clic en el bot√≥n **"Add Key"**.
4. Selecciona la opci√≥n de generar una nueva clave en formato **JSON**.
5. Descarga y **almacena de forma segura** este archivo `.json`.

> üìù Este archivo de credenciales ser√° utilizado por DVC como mecanismo de autenticaci√≥n al conectarse con Google Cloud.

---

## üîó Conectar DVC a Google Drive o Google Cloud Storage

En esta pr√°ctica hemos dado las instrucciones para conectar DVC a dos almacenamientos remotos. DVC permite definir m√∫ltiples remotos y seleccionar cu√°l usar como predeterminado o indicar uno espec√≠fico al momento de hacer `dvc push`, `dvc pull`, o `dvc fetch`.

Para configurar dos accesos remotos, podemos usar:
```bash
# Agregar Google Drive como remoto
dvc remote add gdrive-remote gdrive://<ID-de-carpeta>
dvc remote modify gdrive-remote gdrive_use_service_account true

# Agregar Google Cloud Storage como remoto
dvc remote add gcs-remote gs://mi-bucket-dvc
dvc remote modify gcs-remote credentialpath /ruta/a/credenciales.json
```

>Nota: Aqu√≠ no se establece ninguno como predeterminado a√∫n.

### Elegir almacenamiento remoto al hacer `push/pull`

Puedes subir tus datos a un almacenamiento remoto espec√≠fico sin necesidad de cambiar el predeterminado:
```bash
dvc push -r gdrive-remote     # Subir a Google Drive
dvc push -r gcs-remote        # Subir a GCS
```

### ‚≠ê O definir un almacenamiento remoto por defecto
```bash
dvc remote default gcs-remote
```
Luego, cada vez que hagas `dvc push` o `dvc pull`, se usar√° ese sin tener que especificarlo.

üß† Recomendaci√≥n

Si trabajas con equipos o deseas redundancia en almacenamiento, tener m√∫ltiples remotos puede ayudarte a:

- Compartir con quienes no tienen acceso a ciertas plataformas.
- Hacer backups autom√°ticos a diferentes nubes.
- Evaluar velocidad y costos de acceso.